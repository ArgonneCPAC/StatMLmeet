2020-07-27 19:05:44.887447: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-07-27 19:05:44.929484: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Quadro GV100 major: 7 minor: 0 memoryClockRate(GHz): 1.627
pciBusID: 0000:2d:00.0
2020-07-27 19:05:44.929713: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2020-07-27 19:05:44.931048: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2020-07-27 19:05:44.932180: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2020-07-27 19:05:44.932467: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2020-07-27 19:05:44.933825: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2020-07-27 19:05:44.934900: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2020-07-27 19:05:44.938135: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-07-27 19:05:44.940112: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2020-07-27 19:05:44.940444: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-07-27 19:05:44.970511: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2100000000 Hz
2020-07-27 19:05:44.978196: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55e199631b30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-27 19:05:44.978246: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-07-27 19:05:45.084029: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55e197aed740 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-07-27 19:05:45.084089: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Quadro GV100, Compute Capability 7.0
2020-07-27 19:05:45.087078: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Quadro GV100 major: 7 minor: 0 memoryClockRate(GHz): 1.627
pciBusID: 0000:2d:00.0
2020-07-27 19:05:45.087179: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2020-07-27 19:05:45.087210: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2020-07-27 19:05:45.087236: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2020-07-27 19:05:45.087266: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2020-07-27 19:05:45.087295: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2020-07-27 19:05:45.087323: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2020-07-27 19:05:45.087353: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-07-27 19:05:45.097097: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2020-07-27 19:05:45.097215: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2020-07-27 19:05:45.101927: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-07-27 19:05:45.101959: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2020-07-27 19:05:45.101974: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2020-07-27 19:05:45.107522: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 30582 MB memory) -> physical GPU (device: 0, name: Quadro GV100, pci bus id: 0000:2d:00.0, compute capability: 7.0)
Using TensorFlow backend.
WARNING: Logging before flag parsing goes to stderr.
W0727 19:05:46.235974 140279321745216 training_utils.py:1346] Output model missing from loss dictionary. We assume this was done on purpose. The fit and evaluate APIs will not be expecting any data to be passed to model.
(100, 64, 64, 1)
Model: "encoder"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
Field (InputLayer)              [(None, 64, 64, 1)]  0                                            
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 64, 64, 512)  5120        Field[0][0]                      
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 64, 64, 512)  1049088     conv2d[0][0]                     
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 64, 64, 512)  262656      conv2d_1[0][0]                   
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 32, 32, 512)  0           conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 32, 32, 128)  589952      max_pooling2d[0][0]              
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 16, 128)  0           conv2d_3[0][0]                   
__________________________________________________________________________________________________
flatten (Flatten)               (None, 32768)        0           max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
z_mean (Dense)                  (None, 512)          16777728    flatten[0][0]                    
__________________________________________________________________________________________________
z_log_var (Dense)               (None, 512)          16777728    flatten[0][0]                    
__________________________________________________________________________________________________
z (Lambda)                      (None, 512)          0           z_mean[0][0]                     
                                                                 z_log_var[0][0]                  
==================================================================================================
Total params: 35,462,272
Trainable params: 35,462,272
Non-trainable params: 0
__________________________________________________________________________________________________
Model: "model"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
z_sampling (InputLayer)      [(None, 512)]             0         
_________________________________________________________________
dense (Dense)                (None, 512)               262656    
_________________________________________________________________
reshape (Reshape)            (None, 16, 16, 2)         0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 16, 16, 128)       2432      
_________________________________________________________________
up_sampling2d (UpSampling2D) (None, 32, 32, 128)       0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 32, 32, 512)       66048     
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 32, 32, 512)       1049088   
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 32, 32, 512)       2359808   
_________________________________________________________________
up_sampling2d_1 (UpSampling2 (None, 64, 64, 512)       0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 64, 64, 1)         4609      
=================================================================
Total params: 3,744,641
Trainable params: 3,744,641
Non-trainable params: 0
_________________________________________________________________
Model: "VAE"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
Field (InputLayer)              [(None, 64, 64, 1)]  0                                            
__________________________________________________________________________________________________
encoder (Model)                 [(None, 512), (None, 35462272    Field[0][0]                      
__________________________________________________________________________________________________
model (Model)                   (None, 64, 64, 1)    3744641     encoder[1][0]                    
                                                                 encoder[1][1]                    
                                                                 encoder[1][2]                    
__________________________________________________________________________________________________
conv2d (Conv2D)                 (None, 64, 64, 512)  5120        Field[0][0]                      
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 64, 64, 512)  1049088     conv2d[0][0]                     
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 64, 64, 512)  262656      conv2d_1[0][0]                   
__________________________________________________________________________________________________
max_pooling2d (MaxPooling2D)    (None, 32, 32, 512)  0           conv2d_2[0][0]                   
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 32, 32, 128)  589952      max_pooling2d[0][0]              
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 16, 16, 128)  0           conv2d_3[0][0]                   
__________________________________________________________________________________________________
flatten (Flatten)               (None, 32768)        0           max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
z_log_var (Dense)               (None, 512)          16777728    flatten[0][0]                    
__________________________________________________________________________________________________
z_mean (Dense)                  (None, 512)          16777728    flatten[0][0]                    
__________________________________________________________________________________________________
tf_op_layer_add (TensorFlowOpLa [(None, 512)]        0           z_log_var[0][0]                  
__________________________________________________________________________________________________
tf_op_layer_Square_1 (TensorFlo [(None, 512)]        0           z_mean[0][0]                     
__________________________________________________________________________________________________
tf_op_layer_Reshape_2 (TensorFl [(None,)]            0           model[1][0]                      
__________________________________________________________________________________________________
tf_op_layer_Reshape_1 (TensorFl [(None,)]            0           Field[0][0]                      
__________________________________________________________________________________________________
tf_op_layer_sub_1 (TensorFlowOp [(None, 512)]        0           tf_op_layer_add[0][0]            2020-07-27 19:05:50.115841: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2020-07-27 19:05:50.336340: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7

                                                                 tf_op_layer_Square_1[0][0]       
__________________________________________________________________________________________________
tf_op_layer_Exp (TensorFlowOpLa [(None, 512)]        0           z_log_var[0][0]                  
__________________________________________________________________________________________________
tf_op_layer_sub (TensorFlowOpLa [(None,)]            0           tf_op_layer_Reshape_2[0][0]      
                                                                 tf_op_layer_Reshape_1[0][0]      
__________________________________________________________________________________________________
tf_op_layer_sub_2 (TensorFlowOp [(None, 512)]        0           tf_op_layer_sub_1[0][0]          
                                                                 tf_op_layer_Exp[0][0]            
__________________________________________________________________________________________________
tf_op_layer_Square (TensorFlowO [(None,)]            0           tf_op_layer_sub[0][0]            
__________________________________________________________________________________________________
tf_op_layer_Sum (TensorFlowOpLa [(None,)]            0           tf_op_layer_sub_2[0][0]          
__________________________________________________________________________________________________
tf_op_layer_Mean (TensorFlowOpL [()]                 0           tf_op_layer_Square[0][0]         
__________________________________________________________________________________________________
tf_op_layer_mul (TensorFlowOpLa [(None,)]            0           tf_op_layer_Sum[0][0]            
__________________________________________________________________________________________________
tf_op_layer_add_1 (TensorFlowOp [(None,)]            0           tf_op_layer_Mean[0][0]           
                                                                 tf_op_layer_mul[0][0]            
__________________________________________________________________________________________________
tf_op_layer_Mean_1 (TensorFlowO [()]                 0           tf_op_layer_add_1[0][0]          
__________________________________________________________________________________________________
add_loss (AddLoss)              ()                   0           tf_op_layer_Mean_1[0][0]         
==================================================================================================
Total params: 39,206,913
Trainable params: 39,206,913
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 810 samples, validate on 90 samples
Epoch 1/1000
256/810 [========>.....................] - ETA: 29s - loss: 1.8419512/810 [=================>............] - ETA: 9s - loss: 1.6145 768/810 [===========================>..] - ETA: 0s - loss: 1.4582810/810 [==============================] - 23s 28ms/sample - loss: 1.4390 - val_loss: 1.0349
Epoch 2/1000
256/810 [========>.....................] - ETA: 4s - loss: 1.0218512/810 [=================>............] - ETA: 2s - loss: 1.0114768/810 [===========================>..] - ETA: 0s - loss: 1.0087810/810 [==============================] - 6s 8ms/sample - loss: 1.0078 - val_loss: 1.0151
Epoch 3/1000
256/810 [========>.....................] - ETA: 4s - loss: 1.0048512/810 [=================>............] - ETA: 2s - loss: 0.9993768/810 [===========================>..] - ETA: 0s - loss: 0.9976810/810 [==============================] - 6s 8ms/sample - loss: 0.9987 - val_loss: 1.0147
Epoch 4/1000
256/810 [========>.....................] - ETA: 4s - loss: 0.9931512/810 [=================>............] - ETA: 2s - loss: 0.9996768/810 [===========================>..] - ETA: 0s - loss: 0.9977810/810 [==============================] - 6s 8ms/sample - loss: 0.9985 - val_loss: 1.0147
Epoch 5/1000
256/810 [========>.....................] - ETA: 4s - loss: 0.9932512/810 [=================>............] - ETA: 2s - loss: 0.9983768/810 [===========================>..] - ETA: 0s - loss: 0.9970810/810 [==============================] - 7s 8ms/sample - loss: 0.9984 - val_loss: 1.0147
Epoch 6/1000
256/810 [========>.....................] - ETA: 4s - loss: 0.9993512/810 [=================>............] - ETA: 2s - loss: 1.0002768/810 [===========================>..] - ETA: 0s - loss: 0.9979810/810 [==============================] - 7s 9ms/sample - loss: 0.9984 - val_loss: 1.0147
Epoch 7/1000
256/810 [========>.....................] - ETA: 4s - loss: 0.9971512/810 [=================>............] - ETA: 2s - loss: 1.0014768/810 [===========================>..] - ETA: 0s - loss: 0.9973810/810 [==============================] - 7s 9ms/sample - loss: 0.9984 - val_loss: 1.0147
Epoch 8/1000
256/810 [========>.....................] - ETA: 4s - loss: 0.9885512/810 [=================>............] - ETA: 2s - loss: 0.9937768/810 [===========================>..] - ETA: 0s - loss: 0.9959810/810 [==============================] - 7s 9ms/sample - loss: 0.9984 - val_loss: 1.0147
Epoch 9/1000
256/810 [========>.....................] - ETA: 4s - loss: 1.0105512/810 [=================>............] - ETA: 2s - loss: 1.0028768/810 [===========================>..] - ETA: 0s - loss: 1.0001810/810 [==============================] - 8s 9ms/sample - loss: 0.9984 - val_loss: 1.0147
Epoch 10/1000
256/810 [========>.....................] - ETA: 4s - loss: 1.0008512/810 [=================>............] - ETA: 2s - loss: 1.0005768/810 [===========================>..] - ETA: 0s - loss: 0.9987810/810 [==============================] - 8s 9ms/sample - loss: 0.9984 - val_loss: 1.0147
Epoch 11/1000
256/810 [========>.....................] - ETA: 4s - loss: 1.0012512/810 [=================>............] - ETA: 2s - loss: 0.9988768/810 [===========================>..] - ETA: 0s - loss: 0.9977810/810 [==============================] - 8s 9ms/sample - loss: 0.9984 - val_loss: 1.0147
Epoch 12/1000
256/810 [========>.....................] - ETA: 5s - loss: 0.9915512/810 [=================>............] - ETA: 2s - loss: 0.9930768/810 [===========================>..] - ETA: 0s - loss: 0.9983810/810 [==============================] - 8s 9ms/sample - loss: 0.9984 - val_loss: 1.0147
Epoch 13/1000
256/810 [========>.....................] - ETA: 5s - loss: 1.0002512/810 [=================>............] - ETA: 2s - loss: 0.9974768/810 [===========================>..] - ETA: 0s - loss: 0.9978810/810 [==============================] - 8s 9ms/sample - loss: 0.9984 - val_loss: 1.0147
Epoch 14/1000
256/810 [========>.....................] - ETA: 5s - loss: 0.9908512/810 [=================>............] - ETA: 2s - loss: 1.0000768/810 [===========================>..] - ETA: 0s - loss: 0.9997810/810 [==============================] - 8s 9ms/sample - loss: 0.9984 - val_loss: 1.0147
Epoch 15/1000
256/810 [========>.....................] - ETA: 5s - loss: 0.9977512/810 [=================>............] - ETA: 2s - loss: 0.9994768/810 [===========================>..] - ETA: 0s - loss: 0.9991810/810 [==============================] - 8s 9ms/sample - loss: 0.9984 - val_loss: 1.0147
Epoch 16/1000
256/810 [========>.....................] - ETA: 5s - loss: 0.9926512/810 [=================>............] - ETA: 2s - loss: 0.9934768/810 [===========================>..] - ETA: 0s - loss: 0.9978810/810 [==============================] - 8s 9ms/sample - loss: 0.9984 - val_loss: 1.0147
Epoch 17/1000
256/810 [========>.....................] - ETA: 5s - loss: 0.9981512/810 [=================>............] - ETA: 2s - loss: 0.9999768/810 [===========================>..] - ETA: 0s - loss: 0.9980810/810 [==============================] - 8s 9ms/sample - loss: 0.9984 - val_loss: 1.0147
Epoch 18/1000
256/810 [========>.....................] - ETA: 5s - loss: 1.0082512/810 [=================>............] - ETA: 2s - loss: 0.9984768/810 [===========================>..] - ETA: 0s - loss: 0.9979810/810 [==============================] - 8s 9ms/sample - loss: 0.9984 - val_loss: 1.0147
Epoch 19/1000
256/810 [========>.....................] - ETA: 5s - loss: 1.0044512/810 [=================>............] - ETA: 2s - loss: 0.9977768/810 [===========================>..] - ETA: 0s - loss: 0.9980810/810 [==============================] - 8s 9ms/sample - loss: 0.9984 - val_loss: 1.0147
Epoch 20/1000
256/810 [========>.....................] - ETA: 5s - loss: 1.0000512/810 [=================>............] - ETA: 2s - loss: 0.9972768/810 [===========================>..] - ETA: 0s - loss: 0.9985810/810 [==============================] - 8s 9ms/sample - loss: 0.9984 - val_loss: 1.0146
Epoch 21/1000
256/810 [========>.....................] - ETA: 5s - loss: 1.0019512/810 [=================>............] - ETA: 2s - loss: 1.0004768/810 [===========================>..] - ETA: 0s - loss: 0.9980810/810 [==============================] - 8s 9ms/sample - loss: 0.9984 - val_loss: 1.0146
Epoch 22/1000
256/810 [========>.....................] - ETA: 5s - loss: 0.9896512/810 [=================>............] - ETA: 2s - loss: 0.9899768/810 [===========================>..] - ETA: 0s - loss: 0.9979810/810 [==============================] - 8s 9ms/sample - loss: 0.9984 - val_loss: 1.0147
Epoch 23/1000
256/810 [========>.....................] - ETA: 5s - loss: 0.9951512/810 [=================>............] - ETA: 2s - loss: 0.9962768/810 [===========================>..] - ETA: 0s - loss: 0.9972810/810 [==============================] - 8s 9ms/sample - loss: 0.9984 - val_loss: 1.0147
Epoch 24/1000
256/810 [========>.....................] - ETA: 5s - loss: 1.0000512/810 [=================>............] - ETA: 2s - loss: 1.0012768/810 [===========================>..] - ETA: 0s - loss: 0.9982810/810 [==============================] - 8s 9ms/sample - loss: 0.9984 - val_loss: 1.0146
Epoch 25/1000
256/810 [========>.....................] - ETA: 5s - loss: 0.9977512/810 [=================>............] - ETA: 2s - loss: 0.9997768/810 [===========================>..] - ETA: 0s - loss: 0.9977810/810 [==============================] - 8s 9ms/sample - loss: 0.9984 - val_loss: 1.0147
Epoch 26/1000
256/810 [========>.....................] - ETA: 5s - loss: 0.9994512/810 [=================>............] - ETA: 2s - loss: 1.0015768/810 [===========================>..] - ETA: 0s - loss: 0.9988810/810 [==============================] - 8s 9ms/sample - loss: 0.9984 - val_loss: 1.0147
Epoch 27/1000
256/810 [========>.....................] - ETA: 5s - loss: 1.0053512/810 [=================>............] - ETA: 2s - loss: 0.9983768/810 [===========================>..] - ETA: 0s - loss: 0.9986810/810 [==============================] - 8s 9ms/sample - loss: 0.9984 - val_loss: 1.0147
Epoch 28/1000
256/810 [========>.....................] - ETA: 5s - loss: 0.9985512/810 [=================>............] - ETA: 2s - loss: 0.9988768/810 [===========================>..] - ETA: 0s - loss: 0.9990810/810 [==============================] - 8s 9ms/sample - loss: 0.9984 - val_loss: 1.0147
Epoch 29/1000
256/810 [========>.....................] - ETA: 5s - loss: 0.9913512/810 [=================>............] - ETA: 2s - loss: 0.9989768/810 [===========================>..] - ETA: 0s - loss: 0.9981810/810 [==============================] - 8s 9ms/sample - loss: 0.9984 - val_loss: 1.0147
Epoch 30/1000
256/810 [========>.....................] - ETA: 5s - loss: 0.9939512/810 [=================>............] - ETA: 2s - loss: 0.9926768/810 [===========================>..] - ETA: 0s - loss: 0.9972810/810 [==============================] - 8s 9ms/sample - loss: 0.9984 - val_loss: 1.0147
Epoch 31/1000
256/810 [========>.....................] - ETA: 5s - loss: 0.9919512/810 [=================>............] - ETA: 2s - loss: 0.9951768/810 [===========================>..] - ETA: 0s - loss: 0.9961810/810 [==============================] - 8s 9ms/sample - loss: 0.9984 - val_loss: 1.0147
Epoch 32/1000
256/810 [========>.....................] - ETA: 5s - loss: 0.9950512/810 [=================>............] - ETA: 2s - loss: 0.9965768/810 [===========================>..] - ETA: 0s - loss: 0.9985810/810 [==============================] - 8s 9ms/sample - loss: 0.9984 - val_loss: 1.0146
Epoch 33/1000
256/810 [========>.....................] - ETA: 5s - loss: 0.9961512/810 [=================>............] - ETA: 2s - loss: 0.9960768/810 [===========================>..] - ETA: 0s - loss: 0.9994810/810 [==============================] - 8s 9ms/sample - loss: 0.9984 - val_loss: 1.0146
Epoch 34/1000
256/810 [========>.....................] - ETA: 5s - loss: 0.9944512/810 [=================>............] - ETA: 2s - loss: 0.9959768/810 [===========================>..] - ETA: 0s - loss: 0.9991810/810 [==============================] - 8s 9ms/sample - loss: 0.9984 - val_loss: 1.0147
Epoch 35/1000
256/810 [========>.....................] - ETA: 5s - loss: 1.0007512/810 [=================>............] - ETA: 2s - loss: 0.9977768/810 [===========================>..] - ETA: 0s - loss: 0.9984810/810 [==============================] - 8s 9ms/sample - loss: 0.9984 - val_loss: 1.0147
Epoch 36/1000
256/810 [========>.....................] - ETA: 5s - loss: 0.9984512/810 [=================>............] - ETA: 2s - loss: 0.9952768/810 [===========================>..] - ETA: 0s - loss: 0.9988